{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.isValidDeepLink = isValidDeepLink;\n  exports.parseAuthTokensFromUrl = parseAuthTokensFromUrl;\n  /**\n   * Deep link security: validate that a URL uses an allowed scheme before processing.\n   * Prevents open redirect / session fixation attacks via malicious redirect URLs.\n   */\n  var ALLOWED_SCHEMES = ['frontend', 'exp'];\n  function isValidDeepLink(url) {\n    var allowedSchemes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ALLOWED_SCHEMES;\n    try {\n      var parsed = new URL(url);\n      var scheme = parsed.protocol.replace(':', '');\n      return allowedSchemes.includes(scheme.toLowerCase());\n    } catch {\n      return false;\n    }\n  }\n  function parseAuthTokensFromUrl(url) {\n    try {\n      var hash = url.includes('#') ? url.split('#')[1] : '';\n      var query = url.includes('?') ? url.split('?')[1] : '';\n      var params = new URLSearchParams(hash || query);\n      return {\n        accessToken: params.get('access_token'),\n        refreshToken: params.get('refresh_token')\n      };\n    } catch {\n      return {\n        accessToken: null,\n        refreshToken: null\n      };\n    }\n  }\n});","lineCount":40,"map":[[7,2,7,0,"exports"],[7,9,7,0],[7,10,7,0,"isValidDeepLink"],[7,25,7,0],[7,28,7,0,"isValidDeepLink"],[7,43,7,0],[8,2,17,0,"exports"],[8,9,17,0],[8,10,17,0,"parseAuthTokensFromUrl"],[8,32,17,0],[8,35,17,0,"parseAuthTokensFromUrl"],[8,57,17,0],[9,2,1,0],[10,0,2,0],[11,0,3,0],[12,0,4,0],[13,2,5,0],[13,6,5,6,"ALLOWED_SCHEMES"],[13,21,5,21],[13,24,5,24],[13,25,5,25],[13,35,5,35],[13,37,5,37],[13,42,5,42],[13,43,5,43],[14,2,7,7],[14,11,7,16,"isValidDeepLink"],[14,26,7,31,"isValidDeepLink"],[14,27,7,32,"url"],[14,30,7,43],[14,32,7,98],[15,4,7,98],[15,8,7,45,"allowedSchemes"],[15,22,7,69],[15,25,7,69,"arguments"],[15,34,7,69],[15,35,7,69,"length"],[15,41,7,69],[15,49,7,69,"arguments"],[15,58,7,69],[15,66,7,69,"undefined"],[15,75,7,69],[15,78,7,69,"arguments"],[15,87,7,69],[15,93,7,72,"ALLOWED_SCHEMES"],[15,108,7,87],[16,4,8,2],[16,8,8,6],[17,6,9,4],[17,10,9,10,"parsed"],[17,16,9,16],[17,19,9,19],[17,23,9,23,"URL"],[17,26,9,26],[17,27,9,27,"url"],[17,30,9,30],[17,31,9,31],[18,6,10,4],[18,10,10,10,"scheme"],[18,16,10,16],[18,19,10,19,"parsed"],[18,25,10,25],[18,26,10,26,"protocol"],[18,34,10,34],[18,35,10,35,"replace"],[18,42,10,42],[18,43,10,43],[18,46,10,46],[18,48,10,48],[18,50,10,50],[18,51,10,51],[19,6,11,4],[19,13,11,11,"allowedSchemes"],[19,27,11,25],[19,28,11,26,"includes"],[19,36,11,34],[19,37,11,35,"scheme"],[19,43,11,41],[19,44,11,42,"toLowerCase"],[19,55,11,53],[19,56,11,54],[19,57,11,55],[19,58,11,56],[20,4,12,2],[20,5,12,3],[20,6,12,4],[20,12,12,10],[21,6,13,4],[21,13,13,11],[21,18,13,16],[22,4,14,2],[23,2,15,0],[24,2,17,7],[24,11,17,16,"parseAuthTokensFromUrl"],[24,33,17,38,"parseAuthTokensFromUrl"],[24,34,17,39,"url"],[24,37,17,50],[24,39,17,113],[25,4,18,2],[25,8,18,6],[26,6,19,4],[26,10,19,10,"hash"],[26,14,19,14],[26,17,19,17,"url"],[26,20,19,20],[26,21,19,21,"includes"],[26,29,19,29],[26,30,19,30],[26,33,19,33],[26,34,19,34],[26,37,19,37,"url"],[26,40,19,40],[26,41,19,41,"split"],[26,46,19,46],[26,47,19,47],[26,50,19,50],[26,51,19,51],[26,52,19,52],[26,53,19,53],[26,54,19,54],[26,57,19,57],[26,59,19,59],[27,6,20,4],[27,10,20,10,"query"],[27,15,20,15],[27,18,20,18,"url"],[27,21,20,21],[27,22,20,22,"includes"],[27,30,20,30],[27,31,20,31],[27,34,20,34],[27,35,20,35],[27,38,20,38,"url"],[27,41,20,41],[27,42,20,42,"split"],[27,47,20,47],[27,48,20,48],[27,51,20,51],[27,52,20,52],[27,53,20,53],[27,54,20,54],[27,55,20,55],[27,58,20,58],[27,60,20,60],[28,6,21,4],[28,10,21,10,"params"],[28,16,21,16],[28,19,21,19],[28,23,21,23,"URLSearchParams"],[28,38,21,38],[28,39,21,39,"hash"],[28,43,21,43],[28,47,21,47,"query"],[28,52,21,52],[28,53,21,53],[29,6,22,4],[29,13,22,11],[30,8,23,6,"accessToken"],[30,19,23,17],[30,21,23,19,"params"],[30,27,23,25],[30,28,23,26,"get"],[30,31,23,29],[30,32,23,30],[30,46,23,44],[30,47,23,45],[31,8,24,6,"refreshToken"],[31,20,24,18],[31,22,24,20,"params"],[31,28,24,26],[31,29,24,27,"get"],[31,32,24,30],[31,33,24,31],[31,48,24,46],[32,6,25,4],[32,7,25,5],[33,4,26,2],[33,5,26,3],[33,6,26,4],[33,12,26,10],[34,6,27,4],[34,13,27,11],[35,8,27,13,"accessToken"],[35,19,27,24],[35,21,27,26],[35,25,27,30],[36,8,27,32,"refreshToken"],[36,20,27,44],[36,22,27,46],[37,6,27,51],[37,7,27,52],[38,4,28,2],[39,2,29,0],[40,0,29,1],[40,3]],"functionMap":{"names":["<global>","isValidDeepLink","parseAuthTokensFromUrl"],"mappings":"AAA;OCM;CDQ;OEE;CFY"},"hasCjsExports":false},"type":"js/module"}]}